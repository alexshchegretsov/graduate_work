# Проектная работа: диплом

Используется следующий workflow:

user --> Я.Диалоги --> Я.Облако[Cloud Functions] --> Я.Облако VM

### Cloud Functions
* создать облачную функцию, python38
* загрузить артефакт с кодом voice_assist/cloud_app.zip через "способ ZIP-архив"
* там же добавить переменные окружения
    * ASYNC_API_URL - урл апи фильмов - http://{vm ip addr}/api/v1/film/title/
    * FOLDER_ID - id фолдера с яндекс облака в котором создана лямбда
    * SENTRY_URL
    * TRANSLATE_API_KEY
        * создать сервисный аккаунт  https://cloud.yandex.ru/docs/iam/operations/sa/create
        * добавить роль ai.translate.user
        * сгенерировать статический Api ключ - https://cloud.yandex.ru/docs/iam/concepts/authorization/api-key

### Я.Диалоги
- создать диалог -> навык в Алисе
- в backend указать cloud function - выбрать созданную выше
- "Хранить состояние" - чекбокс сделать активным
- сделать навык приватным
- заполнить required-поля
- перейти в "Настройки -> Интенты"
    * создать интенты из voice_assist/intents
    * к примеру ``get_description.intent`` означает, что 
        * Название - "дай описание"
        * ID - get_description
        * Грамматика - содержимое файла
    * создать по аналогии интенты
    
### VM 
* скопировать код на VM
* ``cd async_api && docker-compose -f docker-compose.reviewer.yml up`` 
* подождать пока отработает etl сервис и заполнит эластик

### Как пользоваться
* установить алису на телефон
* запустить навык комбинацией слов(печатаем), которые указали при создании навыка, наподобии "запусти навык такой-то"
* использовать команды
    * в контексте приветственной сцены
        * "Помощь" - команды приветственного контекста
        * "Найди фильм" - поиск фильма и переход в контекст этой команды
    * в контексте команды "Найди фильм"
        * "Помощь" - команды этого контекста
        * "Дай описание" - описание найденного фильма
        * "Найди фильм" - поиск нового фильма
    * из любого контекста
        * "Что ты умеешь"
        * "Хватит" - завершить сеанс